<div class="container mx-auto px-4 py-8">
  <h1
    class="text-3xl font-bold text-center bg-clip-text bg-gradient-to-r from-emerald-200 to-emerald-900 mb-6"
  >
    Product List
  </h1>

  <table class="min-w-full bg-white border border-gray-100 shadow-lg">
    <thead>
      <tr class="bg-gray-100">
        <th
          class="py-2 px-4 border-b text-left cursor-pointer"
          (click)="onSearch('pId')"
        >
          <span *ngIf="searchColumn !== 'pId'"
            >Product ID <i class="fas fa-search text-sm ml-2"></i
          ></span>
          <input
            *ngIf="searchColumn === 'pId'"
            [(ngModel)]="searchText"
            (input)="applySearch()"
            (blur)="clearSearch()"
            class="mt-1 p-1 border border-gray-300 rounded"
            placeholder="Search Product ID"
          />
        </th>
        <th
          class="py-2 px-4 border-b text-left cursor-pointer"
          (click)="onSearch('pName')"
        >
          <span *ngIf="searchColumn !== 'pName'"
            >Product Name <i class="fas fa-search text-sm ml-2"> </i
          ></span>
          <input
            *ngIf="searchColumn === 'pName'"
            [(ngModel)]="searchText"
            (input)="applySearch()"
            (blur)="clearSearch()"
            class="mt-1 p-1 border border-gray-300 rounded"
            placeholder="Search Product Name"
          />
        </th>
        <th
          class="py-2 px-4 border-b text-left cursor-pointer"
          (click)="onSearch('pDescription')"
        >
          <span *ngIf="searchColumn !== 'pDescription'"
            >Description <i class="fas fa-search text-sm ml-2"></i
          ></span>
          <input
            *ngIf="searchColumn === 'pDescription'"
            [(ngModel)]="searchText"
            (input)="applySearch()"
            (blur)="clearSearch()"
            class="mt-1 p-1 border border-gray-300 rounded"
            placeholder="Search Description"
          />
        </th>
        <th
          class="py-2 px-4 border-b text-left cursor-pointer"
          (click)="onSearch('pPrice')"
        >
          <span *ngIf="searchColumn !== 'pPrice'"
            >Price <i class="fas fa-search text-sm ml-2"></i
          ></span>
          <input
            *ngIf="searchColumn === 'pPrice'"
            [(ngModel)]="searchText"
            (input)="applySearch()"
            (blur)="clearSearch()"
            class="mt-1 p-1 border border-gray-300 rounded"
            placeholder="Search Price"
          />
        </th>
        <th
          class="py-2 px-4 border-b text-left cursor-pointer"
          (click)="onSearch('pQuantity')"
        >
          <span *ngIf="searchColumn !== 'pQuantity'"
            >Quantity <i class="fas fa-search text-sm ml-2"></i
          ></span>
          <input
            *ngIf="searchColumn === 'pQuantity'"
            [(ngModel)]="searchText"
            (input)="applySearch()"
            (blur)="clearSearch()"
            class="mt-1 p-1 border border-gray-300 rounded"
            placeholder="Search Quantity"
          />
        </th>
        <th class="py-2 px-4 border-b text-left">Barcode</th>
      </tr>
    </thead>

    <tbody *ngIf="filteredProducts.length > 0; else noProducts">
      <tr *ngFor="let product of filteredProducts" class="hover:bg-gray-50">
        <td class="py-2 px-4 border-b">{{ product.pId }}</td>
        <td class="py-2 px-4 border-b">{{ product.pName }}</td>
        <td class="py-2 px-4 border-b">{{ product.pDescription }}</td>
        <td class="py-2 px-4 border-b">{{ product.pPrice }}</td>
        <td class="py-2 px-4 border-b">{{ product.pQuantity }}</td>
        <td class="py-2 px-4 border-b">
          <div *ngIf="product.barcode" class="relative">
            <img
              [src]="product.barcode"
              alt="Barcode for {{ product.pName }}"
              class="w-16 h-auto transition-transform duration-300 ease-in-out transform hover:scale-150"
            />
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <ng-template #noProducts>
    <div *ngIf="loading" class="flex justify-center items-center h-full">
      <div
        class="w-36 h-36 border-4 border-t-emerald-700 border-emerald-200 rounded-full animate-spin"
      ></div>
    </div>
    <div class="text-center p-10">
      <p class="text-xl text-gray-500 font-semibold">No products available.</p>
      <p class="text-sm text-gray-400 mt-2">
        Please check back later or add new products.
      </p>
    </div>
  </ng-template>
</div>
